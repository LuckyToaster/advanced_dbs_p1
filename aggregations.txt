
//List of all people who have studied at the UPM or UAM.
//Lookup to merch on specific field
//Match to find educenters which match it

db.users.aggregate([
    {
        $lookup: {
            from: "EducationalCentre",
            localField: "EducationalCentre",
            foreignField: "code",
            as: "userEduMerch"
        }
    },
    {
        $match: {
            "userEduMerch.name": { $in: ["UAM", "UPM"] }
        }
    }
])

//List of the different universities in which people residing in Madrid have studied.

db.users.aggregate([
    {
        $match: {
            "address": "Madrid"
        }
    },
    {
        $lookup: {
            from: "EducationalCentre",
            localField: "EducationalCentre",
            foreignField: "code",
            as: "studentsInMadrid"
        }
    },
    {
        $project: {
            "studentsInMadrid.name": 1,
        }
    },
    {
        $unwind: "$studentsInMadrid"
    },
    {
        $group: {
            _id: "$studentsInMadrid.name"
        }
    }
])

//People who, in their profile description, include the terms "Big Data" or "Artificial Ingeligence"
//i = case insensitive
db.users.aggregate([
    $match: {
        content: {$regex: "Big Data|Artificial Inteligence", $options: "i"}
    }
])

4.
Save in a new table the list of people who have completed one of their studies in 2017 or later.
5.
Calculate the average number of studies carried out by people who have worked or work at Microsoft.
6.
Average distance to work (geodesic distance) of current Google workers. You can enter Google office coordinates manually.
7.
List of the three universities that most often appear as a study center